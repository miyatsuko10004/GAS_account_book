# GAS_account_book
GASで作成する家計簿アプリ

バケット型家計簿 取扱説明書
1. 概要
このアプリケーションは、Google Apps Scriptで動作する、齋藤様ご夫婦の家計管理スタイルに最適化されたウェブベースの家計簿です。

単なる収支の記録に留まらず、収入を目的別の「口座（バケット）」に振り分け、それぞれの残高を管理する**「バケット方式」**を採用しています。特に、「妻の給料は生活費の原資」「夫の給料は貯金」という実際の運用フローをアプリの核に据えることで、毎月の家計管理を直感的かつ効率的に行うことを目指しています。

すべてのデータはご自身のGoogleスプレッドシートで管理されるため、プライバシーとセキュリティが確保されます。

2. 主な機能
給料日のかんたん登録ウィザード: 毎月の給料を簡単なステップで登録し、設定に基づいて自動で振り分けます。

口座（バケット）設定: 「消費支出」と「貯金・積立」の種別や、グループ、目標金額などを口座ごとに細かく設定できます。

予算の振分とテンプレート機能: 妻の給料を原資として、各口座に予算を振り分けます。そのパターンはテンプレートとして保存・呼出が可能です。

ダッシュボード: 「貯金・積立」口座の残高やグループごとの合計額、振分可能な生活費の残額などを一目で確認できます。

取引履歴の確認・編集: 過去のすべての取引（収入、支出、振分）を一覧で確認し、修正や削除が可能です。

将来の出費管理: 車の購入など、将来の大きな出費を予定日と引き落とし口座を指定して登録できます。

多角的な将来シミュレーション: 保存したテンプレートと将来の出費に基づき、指定した貯金口座の3年後の残高推移をグラフで視覚的に予測します。

3. セットアップ手順
このアプリをゼロからセットアップするための手順です。

ステップ1：Googleスプレッドシートの準備

新しいスプレッドシートを作成し、「バケット型家計簿」など、ご自身で分かりやすい名前を付けます。

シート下部のタブを操作し、以下の4つのシートを、指定された名前で作成します。

Accounts

Transactions

AllocationTemplates

FutureExpenses

各シートの1行目に、以下のヘッダー（列名）をそれぞれ入力してください。（列の順番や名前が異なると動作しません）

Accounts シート:
| 列 | ヘッダー名 | 内容 |
| :--- | :--- | :--- |
| A | Category | 口座名（例: 家賃, 生活防衛費, 車貯金）。この名前がアプリ全体で使われます。 |
| B | Balance | 現在の残高。スクリプトが自動計算するため、手動で編集する必要はありません。 |
| C | Type | 口座の種類。「消費支出」または「貯金・積立」から選択します。 |
| D | Group | 口座が属するグループ名（例: 2人の貯金, 生活費）。空欄も可。 |
| E | Goal | 目標金額。「貯金・積立」タイプの口座に任意で設定します。 |
| F | IsDefault | 夫の給料のデフォルト入金先にするか。TRUEまたはFALSEで設定します。 |
| G | ID | 口座の一意のID。スクリプトが自動で割り振ります。 |

Transactions シート:
| 列 | ヘッダー名 | 内容 |
| :--- | :--- | :--- |
| A | ID | 取引ごとの一意のID。スクリプトが自動で割り振ります。 |
| B | Date | 取引が発生した日付。 |
| C | Type | 取引の種類。「収入」「支出」「振分」のいずれか。 |
| D | Amount | 金額。 |
| E | Category | 関連する口座名、または収入の場合は収入源（例: 妻の給料）。 |
| F | Memo | 取引に関するメモ（任意）。 |

AllocationTemplates シート:
| 列 | ヘッダー名 | 内容 |
| :--- | :--- | :--- |
| A | TemplateName | テンプレートの名前（例: 基本パターン）。 |
| B | Type | 「収入」または「振分」のいずれか。 |
| C | Category | 収入源、または振分先の口座名。 |
| D | Amount | 金額。 |
| E | IsExpense | その振分が「消費支出」であるか。TRUEまたはFALSEで設定します。 |

FutureExpenses シート:
| 列 | ヘッダー名 | 内容 |
| :--- | :--- | :--- |
| A | ID | 将来の出費の一意のID。スクリプトが自動で割り振ります。 |
| B | Name | 出費名（例: 車の購入）。 |
| C | Amount | 予定金額。 |
| D | Date | 予定日。 |
| E | SourceAccount | この出費を引き落とす予定の口座名。 |

スプレッドシートのURL（例: https://docs.google.com/spreadsheets/d/【この部分がIDです】/edit）から、スプレッドシートIDをコピーしておきます。

ステップ2：Apps Scriptの設定

作成したスプレッドシートで、「拡張機能」メニューから「Apps Script」を選択します。

スクリプトエディタが開いたら、Code.gsとIndex.htmlという2つのファイルがあることを確認します。（もしIndex.htmlがなければ、ファイル横の「+」からHTMLファイルを追加してください）

Code.gsの既存のコードをすべて削除し、提供されたソースコードの/* --- ここから下が Code.gs の内容 --- */以下の部分を貼り付けます。

貼り付けたCode.gsのコードの2行目にあるconst SS_ID = '...';の'...'の部分を、ステップ1-4でコピーしたご自身のスプレッドシートIDに書き換えます。

Index.htmlの既存のコードをすべて削除し、提供されたソースコードのHTML部分（<!DOCTYPE html>から</html>まで）を貼り付けます。

Ctrl + SまたはCmd + Sで両方のファイルを保存します。

ステップ3：ウェブアプリとしてデプロイ

スクリプトエディタの右上にある青い「デプロイ」ボタンをクリックし、「新しいデプロイ」を選択します。

歯車アイコンの「種類の選択」で「ウェブアプリ」を選択します。

以下の通りに設定します。

説明: （空欄でOK）

次のユーザーとして実行: 自分

アクセスできるユーザー: 自分のみ

「デプロイ」ボタンをクリックします。

初回は「承認が必要です」というダイアログが表示されます。「アクセスを承認」をクリックし、ご自身のGoogleアカウントを選択してください。

「このアプリはGoogleで確認されていません」という警告が出たら、「詳細」をクリックし、「（安全でないページ）に移動」をクリックして、アクセスを許可します。

デプロイが完了すると表示されるウェブアプリのURLをコピーします。このURLが、あなたの家計簿アプリのアドレスになります。ブックマークしておくと便利です。

4. 使い方（推奨ワークフロー）
【初回のみ】口座設定:

「口座設定」タブを開き、ご自身の家計で管理したい項目（家賃、食費、生活防衛費、2人の貯金、車貯金など）をすべて口座として登録します。

各口座の「種類」（消費支出か貯金・積立か）や「グループ」を適切に設定します。

「夫の給料の入金先にする」チェックボックスを、いずれか一つの貯金口座（例：「2人の貯金」）に設定します。

【毎月】給料の登録:

25日と末日になったら、ヘッダーの「給料を登録」ボタンから、それぞれの給料を登録します。

妻の給料は「振分可能なお金」に、夫の給料は設定したデフォルト口座に自動で振り込まれます。

【毎月】予算の振分:

「予算の振分」タブを開きます。

テンプレートを読み込むか、手動で各口座に振り分ける金額を入力します。

「この内容で振り分ける」ボタンを押すと、「振分可能なお金」が各口座に移動します。「消費支出」にチェックを入れた項目は、振り分けと同時に支出としても記録されます。

【随時】日々の取引記録:

「取引記録」タブから、日々の支出を「どの口座から」支払ったかを意識して記録します。

【随時】状況確認と計画:

「ダッシュボード」で貯金の状況を確認します。

「シミュレーション」で将来の資産推移を確認し、必要に応じて計画を見直します。

5. 各シートの役割（詳細）
Accounts: アプリで管理するすべての口座のマスタデータです。残高はTransactionsシートから自動計算されるため、直接編集する必要はありません。口座の追加や設定変更は、アプリの「口座設定」画面から行います。

Transactions: すべての取引（収入、支出、振分）が記録される台帳です。アプリの「取引記録」や「取引履歴」画面から操作します。

AllocationTemplates: 「予算の振分」画面で使うテンプレートのデータが保存されます。アプリ上から作成・更新します。

FutureExpenses: シミュレーションに使う将来の大きな出費のデータが保存されます。アプリの「将来の出費」画面から操作します。

